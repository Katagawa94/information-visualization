import{s as H}from"./transform.3ec6140b.js";import{E as N}from"./ExerciseContainer.b0ab4103.js";import{S as P}from"./svgConfigs.64a9696a.js";import{_ as j,d as F,q as D,a as O,o as z,c as R,w as T,b as u,t as M}from"./index.36e3ba2a.js";import{m as A}from"./max.0df7e00c.js";import{b as W,r as x}from"./band.628a8d04.js";import{l as q}from"./linear.be5e5768.js";import{o as I}from"./ordinal.29744db8.js";import{c as L}from"./colors.6aafad43.js";import{a as Q,b}from"./axis.0fbd6d3f.js";import"./use-dark.03be42c5.js";import"./render.79ae91dc.js";import"./init.0b4a962a.js";var J=L("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");const K="/information-visualization/";async function U(){try{const d=await fetch(`${K}data/dataBip.csv`);if(!d.ok)throw new Error("Failed to load CSV");const m=await d.text(),f=X(m);return Y(f)}catch(d){console.error("Error loading CSV:",d)}return[]}function X(d){return d.split(`
`).map(s=>s.split(","))}function Y(d){return d.slice(1).map(s=>({group:Number(s[0]),series:Number(s[1]),value:Number(s[2])})).filter(s=>s.group&&s.series&&s.value)}const Z=F({__name:"Exercise1",setup(d){const m=D("stacked");function f(i){const e={};for(let n=0;n<i.length;n++){const a=i[n];e[a.series]||(e[a.series]=[]),e[a.series].push({group:a.group,series:a.series,value:a.value,y0:0,y1:a.value})}const c=Object.keys(e);for(let n=1;n<c.length;n++){const a=e[c[n]];for(let l=0;l<a.length;l++)a[l].y0=e[c[n-1]][l].y1,a[l].y1=a[l].y0+a[l].value}return Object.values(e)}async function s(){var C,_;const i=await U(),e=Array.from(new Set(i.map(t=>t.group))),c=Array.from(new Set(i.map(t=>t.series))),n=c.length,a=new P(1400,700,{top:40,right:10,bottom:20,left:50,xlabel:20,ylabel:20}),l=f(i),B=(C=A(i,t=>t.value))!=null?C:0,w=(_=A(l.flatMap(t=>t.map(r=>r.y1))))!=null?_:0,g=H("#plotContainer").attr("width",a.svgWidth).attr("height",a.svgHeight).attr("fill","red").append("g").attr("transform",`translate(${a.margin.left+a.margin.xlabel} , ${a.margin.top})`),p=W().domain(e).rangeRound([0,a.innerWidth]).padding(.3),o=q().domain([0,w]).range([a.innerHeight,0]),S=I(J).domain(x(n).map(String)),h=g.selectAll(".series").data(l).enter().append("g").attr("fill",(t,r)=>S(String(r))).selectAll("rect").data(t=>t).enter().append("rect").attr("x",t=>p(t.group)).attr("y",a.innerHeight).attr("width",p.bandwidth()).attr("height",0);h.transition().delay((t,r)=>r*10).attr("y",t=>o(t.y1)).attr("height",t=>o(t.y0)-o(t.y1)),g.append("g").attr("class","axis axis--x").attr("transform",`translate(0,${a.innerHeight})`).call(Q(p).tickSize(0).tickPadding(6));const k=g.append("g").call(b(o));$();function E(){o.domain([0,B]),k.call(b(o)),h.transition().duration(500).delay((t,r)=>r*10).attr("x",t=>p(t.group)+p.bandwidth()/n*c.indexOf(t.series)).attr("width",p.bandwidth()/n).transition().attr("y",t=>o(t.y1-t.y0)).attr("height",t=>o(0)-o(t.y1-t.y0))}function V(){o.domain([0,w]),k.call(b(o)),h.transition().duration(500).delay((t,r)=>r*10).attr("y",t=>o(t.y1)).attr("height",t=>o(t.y0)-o(t.y1)).transition().attr("x",t=>p(t.group)).attr("width",p.bandwidth())}function $(){const t=g.append("g").attr("transform",`translate(0,${a.innerHeight+a.margin.bottom})`);t.selectAll("circle").data(x(n)).enter().append("circle").attr("cx",(r,v)=>v*150).attr("cy",10).attr("r",10).attr("fill",r=>S(String(r))),t.selectAll(".bar-label").data(x(n)).enter().append("text").attr("class","bar-label").text(r=>"Quartal "+(r+1)).attr("x",(r,v)=>v*150+45).attr("y",15).attr("text-anchor","middle").attr("fill","black")}function G(t){m.value=t,t==="grouped"?E():V()}return{changeMode:G}}const y=D();return O(async()=>{const{changeMode:i}=await s();i("stacked"),y.value=i}),(i,e)=>(z(),R(N,null,{default:T(()=>[e[4]||(e[4]=u("h2",null,"Stacked and Grouped Bars - GDP of germany",-1)),u("form",null,[u("label",null,[u("input",{type:"radio",name:"mode",value:"grouped",onChange:e[0]||(e[0]=c=>y.value("grouped"))},null,32),e[2]||(e[2]=M(" Grouped "))]),u("label",null,[u("input",{type:"radio",name:"mode",value:"stacked",checked:"",onChange:e[1]||(e[1]=c=>y.value("stacked"))},null,32),e[3]||(e[3]=M(" Stacked "))])]),e[5]||(e[5]=u("svg",{id:"plotContainer"},null,-1))]),_:1}))}});var gt=j(Z,[["__scopeId","data-v-20a6be35"]]);export{gt as default};

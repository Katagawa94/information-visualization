import{s as j}from"./transform.36d866f3.js";import{E as F}from"./ExerciseContainer.1237914e.js";import{S as O}from"./models.0d1b92b4.js";import{_ as z,d as R,q as S,a as T,o as W,c as q,w as I,b as c,t as k}from"./index.736792e7.js";import{m as C}from"./max.0df7e00c.js";import{b as L,r as g}from"./band.628a8d04.js";import{l as Q}from"./linear.f42d7650.js";import{o as J}from"./ordinal.29744db8.js";import{c as K}from"./colors.6aafad43.js";import{a as U,b as y}from"./axis.0fbd6d3f.js";import"./use-dark.f662dfdc.js";import"./render.37684453.js";import"./init.0b4a962a.js";var X=K("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");const Y=R({__name:"Exercise1",setup(Z){const _="/information-visualization/",D=S("stacked");async function M(){try{const n=await fetch(`${_}data/dataBip.csv`);if(!n.ok)throw new Error("Failed to load CSV");const a=await n.text(),i=A(a);return B(i)}catch(n){console.error("Error loading CSV:",n)}return[]}function A(n){return n.split(`
`).map(e=>e.split(","))}function B(n){return n.slice(1).map(e=>({group:Number(e[0]),series:Number(e[1]),value:Number(e[2])})).filter(e=>e.group&&e.series&&e.value)}function E(n){const a={};for(let e=0;e<n.length;e++){const r=n[e];a[r.series]||(a[r.series]=[]),a[r.series].push({group:r.group,series:r.series,value:r.value,y0:0,y1:r.value})}const i=Object.keys(a);for(let e=1;e<i.length;e++){const r=a[i[e]];for(let l=0;l<r.length;l++)r[l].y0=a[i[e-1]][l].y1,r[l].y1=r[l].y0+r[l].value}return Object.values(a)}async function V(){var b,w;const n=await M(),a=Array.from(new Set(n.map(t=>t.group))),i=Array.from(new Set(n.map(t=>t.series))),e=i.length,r=new O(1400,700,{top:40,right:10,bottom:20,left:50,xlabel:20,ylabel:20}),l=E(n),$=(b=C(n,t=>t.value))!=null?b:0,h=(w=C(l.flatMap(t=>t.map(o=>o.y1))))!=null?w:0,p=j("#plotContainer").attr("width",r.svgWidth).attr("height",r.svgHeight).attr("fill","red").append("g").attr("transform",`translate(${r.margin.left+r.margin.xlabel} , ${r.margin.top})`),d=L().domain(a).rangeRound([0,r.innerWidth]).padding(.3),s=Q().domain([0,h]).range([r.innerHeight,0]),v=J(X).domain(g(e).map(String)),m=p.selectAll(".series").data(l).enter().append("g").attr("fill",(t,o)=>v(String(o))).selectAll("rect").data(t=>t).enter().append("rect").attr("x",t=>d(t.group)).attr("y",r.innerHeight).attr("width",d.bandwidth()).attr("height",0);m.transition().delay((t,o)=>o*10).attr("y",t=>s(t.y1)).attr("height",t=>s(t.y0)-s(t.y1)),p.append("g").attr("class","axis axis--x").attr("transform",`translate(0,${r.innerHeight})`).call(U(d).tickSize(0).tickPadding(6));const x=p.append("g").call(y(s));N();function G(){s.domain([0,$]),x.call(y(s)),m.transition().duration(500).delay((t,o)=>o*10).attr("x",t=>d(t.group)+d.bandwidth()/e*i.indexOf(t.series)).attr("width",d.bandwidth()/e).transition().attr("y",t=>s(t.y1-t.y0)).attr("height",t=>s(0)-s(t.y1-t.y0))}function H(){s.domain([0,h]),x.call(y(s)),m.transition().duration(500).delay((t,o)=>o*10).attr("y",t=>s(t.y1)).attr("height",t=>s(t.y0)-s(t.y1)).transition().attr("x",t=>d(t.group)).attr("width",d.bandwidth())}function N(){const t=p.append("g").attr("transform",`translate(0,${r.innerHeight+r.margin.bottom})`);t.selectAll("circle").data(g(e)).enter().append("circle").attr("cx",(o,f)=>f*150).attr("cy",10).attr("r",10).attr("fill",o=>v(String(o))),t.selectAll(".bar-label").data(g(e)).enter().append("text").attr("class","bar-label").text(o=>"Quartal "+(o+1)).attr("x",(o,f)=>f*150+45).attr("y",15).attr("text-anchor","middle").attr("fill","black")}function P(t){D.value=t,t==="grouped"?G():H()}return{changeMode:P}}const u=S();return T(async()=>{const{changeMode:n}=await V();n("stacked"),u.value=n}),(n,a)=>(W(),q(F,null,{default:I(()=>[a[4]||(a[4]=c("h2",null,"Stacked and Grouped Bars - GDP of germany",-1)),c("form",null,[c("label",null,[c("input",{type:"radio",name:"mode",value:"grouped",onChange:a[0]||(a[0]=i=>u.value("grouped"))},null,32),a[2]||(a[2]=k(" Grouped "))]),c("label",null,[c("input",{type:"radio",name:"mode",value:"stacked",checked:"",onChange:a[1]||(a[1]=i=>u.value("stacked"))},null,32),a[3]||(a[3]=k(" Stacked "))])]),a[5]||(a[5]=c("svg",{id:"plotContainer"},null,-1))]),_:1}))}});var gt=z(Y,[["__scopeId","data-v-2e4b2268"]]);export{gt as default};
